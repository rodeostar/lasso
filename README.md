# Lasso

Simple typescript framework.

[View the Demo](https://lasso-h3smx.ondigitalocean.app/) 


### Setup:

`npx @rodeostar/lasso --init`


### CLI Options:

`--watch` - Dev server mode
`--init`  - Scaffolds a template in an empty directory


### Features:

- Blockdom virtual DOM (it's fast)
- Server side rendering (SEO friendly)
- Client routing (fluid user  experience)
- Static first approach (keep   client assets small)
- API Routes
- Template  literal templates


<img src="https://user-images.githubusercontent.com/5882632/187812779-8b10fed4-45b7-4f29-b28e-b7c3ace99206.png" width="640" height="auto" />


## Application Structure
Lasso uses convention to determine application routing. 

```bash
: lasso.config.json         # Lasso configuration, required to run lasso
: tsconfig.json
: package.json
: .lasso/*                  # Autogenerated, storage location for built ts and other runtime objects
: src/                      # src is always the root directory and should have a pages and api folder
: : pages/                  # lasso looks here for pages routes. 
: : : index.ts              #    becomes https://0.0.0.0:8585/
: : : some-page.ts          #    becomes https://0.0.0.0:8585/some-page
: : api/                    # lasso looks here for API routes here
: : : hi.ts                 #    becomes HTTP/R https://0.0.0.0:8585/api/hi
: : : names/                #
: : : : [name].ts           #    becomes HTTP/R https://0.0.0.0:8585/api/names/:name
                            #    i.e. GET /api/names/frank -> { name: "frank" }

```

## Page Anatomy
Here's an  example of an index.ts file, in the src/pages directory,
Lasso serves this page at the "/" route of the app.
```typescript
// Import the Functional Component type (FC)
import type { FC } from "@rodeostar/lasso";

// Declare a functional component
const Home: FC = () => {

  // Return the render method
  return ({ html, css }) => {

    // Return an HTML directive
    return html`<div class=${css("font-serif")}>hello home</div>`;
  }
}

// Page export MUST be exported as default
export default Home;

// __Page settings, i.e. head <title> tags
export const __Page = {
  head: {
    title: "Homepage",
  },
};

```


## API anatomy

```typescript
// Import the Handler type
import type { Handler } from "@rodeostar/lasso";

// Create a handler, and annotate it with the Handler type
const HelloWorldHandler: Handler = (server, route) => {
  // server is an instance of Fastify. i.e. server.get, server.post, server.put, etc.
  // route is the pathname the user visited, this is helpful for parsing params
  server.get(route, (request, reply) => {
    reply.send({ hello: "world" });
  });
};

// Handlers MUST be exported as default
export default HelloWorldHandler;

```

## Components
Components are built the same way as a page, using the FC type.

Here's an example that utilizes Lasso's built in shared store utility:

```typescript
import { FC, Store } from "@rodeostar/lasso";
import { makeExample, makeButton } from "../styles";

export type Actions = "increment" | "decrement";

export const appStorage = new Store<number, Actions>(0, {
  increment(prevState) {
    return prevState + 1;
  },
  decrement(prevState) {
    return prevState - 1;
  },
});


export const StorageCounter: FC = () => {
  return ({ html, css, connect }) => {
    const styles = {
      button: css("btn"),
      example: css("example-class"),
      textInput: css("border border-[#eee] rounded-md p-2"),
      grid: css("grid grid-cols-1 gap-y-4 max-w-[300px]"),
    };

    const store = connect(appStorage);

    return html`<div class=${styles.example}>
      <p class=${css("mb-2")}>
        Store equals
        <span class=${css("text-2xl")}> ${store.state()}</span>
      </p>

      <button
        class=${styles.button}
        onClick=${() => store.dispatch("increment")}
      >
        + (${store.state()})
      </button>

      <button
        class=${styles.button}
        onClick=${() => store.dispatch("decrement")}
      >
        - (${store.state()})
      </button>
    </div>`;
  };
};

```

## In the Future
This framework was put together quickly. Some future enhancements:

- Better component nesting ergonomics
- Improvements to development server (specifically performance)
- `npx @rodeostar/lasso --build`
- More SASS/CSS options
- LazyLoad utilities


## Framework API

@TODO


## Configuring Lasso

@TODO

